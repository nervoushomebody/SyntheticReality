<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AR –í—ñ–∑–∏—Ç—ñ–≤–∫–∞ - –ö–æ—Ç—è—Ç–∫–∏ —Ä–æ–∂–µ–≤—è—Ç–∫–∏</title>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.1.4/dist/mindar-image-three.prod.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.150.1/build/three.min.js"></script>
    <style>
        html, body { margin: 0; padding: 0; height: 100%; width: 100%; overflow: hidden; }
        canvas { display: block; }
        #instructions { 
            position: absolute; 
            bottom: 20px; 
            left: 20px; 
            color: white; 
            /* --- –ó–ú–Ü–ù–ï–ù–û –ö–û–õ–Ü–† –Ü–ù–°–¢–†–£–ö–¶–Ü–á --- */
            background: rgba(244, 198, 198, 0.8); /* #f4c6c6 –∑ –ø—Ä–æ–∑–æ—Ä—ñ—Å—Ç—é */
            padding: 10px; 
            border-radius: 5px; 
            font-size: 14px; 
            z-index: 1000; 
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
        }
    </style>
</head>
<body>
    <div id="instructions">–ù–∞–≤–µ–¥—ñ—Ç—å –∫–∞–º–µ—Ä—É –Ω–∞ AR-–º–∞—Ä–∫–µ—Ä</div>

    <script>
        // –î–æ–ø–æ–º—ñ–∂–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–µ–∫—Å—Ç—É—Ä
        const createTextTexture = (text, fontSize = 64, color = '#ffffff', bgColor = '#000000') => {
            const canvas = document.createElement('canvas');
            const context = canvas.getContext('2d');
            canvas.width = 1024;
            canvas.height = 256;
            
            context.fillStyle = bgColor;
            context.fillRect(0, 0, canvas.width, canvas.height);
            
            context.fillStyle = color;
            context.font = `bold ${fontSize}px Arial`;
            context.textAlign = 'center';
            context.textBaseline = 'middle';
            
            const lines = text.split('\n');
            lines.forEach((line, index) => {
                context.fillText(line, canvas.width / 2, canvas.height / 2 + (index - (lines.length - 1) / 2) * fontSize * 1.1);
            });

            return new THREE.CanvasTexture(canvas);
        };

        document.addEventListener("DOMContentLoaded", async () => {
            const mindarThree = new window.MINDAR.IMAGE.MindARThree({
                container: document.body,
                imageTargetSrc: "./targets.mind",
            });

            const { renderer, scene, camera } = mindarThree;
            const anchor = mindarThree.addAnchor(0);
            const group = new THREE.Group();
            anchor.group.add(group);

            const light = new THREE.HemisphereLight(0xffffff, 0xbbbbff, 1.2); // –¢—Ä–æ—Ö–∏ –±—ñ–ª—å—à–µ —Å–≤—ñ—Ç–ª–∞
            scene.add(light);

            // --- –û–°–ù–û–í–ù–Ü –ï–õ–ï–ú–ï–ù–¢–ò –ó –ù–û–í–û–Æ –ü–ê–õ–Ü–¢–†–û–Æ ---

            // 1. –û—Å–Ω–æ–≤–Ω–∞ –∫–∞—Ä—Ç–∫–∞ –∑ —ñ–º–µ–Ω–µ–º
            const cardGeometry = new THREE.PlaneGeometry(1, 0.5);
            // --- –ó–ú–Ü–ù–ï–ù–û –ö–û–õ–¨–û–†–ò –ö–ê–†–¢–ö–ò ---
            const cardTexture = createTextTexture(
                '–Æ–ª—ñ—è\n–ü—Ä–æ—Ñ–µ—Å—ñ–æ–Ω–∞–ª—å–Ω–∏–π –ø—Ä–æ–∫—Ä–∞—Å—Ç–∏–Ω–∞—Ç–æ—Ä', 
                48, 
                '#a37b73', // –¢–µ–ø–ª–∏–π –∫–æ—Ä–∏—á–Ω–µ–≤–∏–π —Ç–µ–∫—Å—Ç –¥–ª—è —á–∏—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—ñ
                '#fce7e7'  // –§–æ–Ω #fce7e7
            );
            const cardMaterial = new THREE.MeshBasicMaterial({ map: cardTexture });
            const businessCard = new THREE.Mesh(cardGeometry, cardMaterial);
            group.add(businessCard);

            // 2. –Ü–∫–æ–Ω–∫–∏-–∫–Ω–æ–ø–∫–∏
            const iconSize = 0.2;
            const iconGeometry = new THREE.PlaneGeometry(iconSize, iconSize);

            // –ö–Ω–æ–ø–∫–∞ "Email" –∑ –ª–∞–ø–∫–æ—é
            // --- –ó–ú–Ü–ù–ï–ù–û –ö–û–õ–¨–û–†–ò –ö–ù–û–ü–ö–ò 1 ---
            const emailTexture = createTextTexture('üêæ', 100, '#ffffff', '#ffcdc1'); // –ë—ñ–ª–∞ –ª–∞–ø–∫–∞ –Ω–∞ —Ñ–æ–Ω—ñ #ffcdc1
            const emailMaterial = new THREE.MeshBasicMaterial({ map: emailTexture });
            const emailIcon = new THREE.Mesh(iconGeometry, emailMaterial);
            emailIcon.position.set(-0.3, -0.4, 0.01);
            emailIcon.userData = { 
                clickable: true, 
                action: 'link', 
                url: 'mailto:vash.email@example.com'
            };
            group.add(emailIcon);

            // –ö–Ω–æ–ø–∫–∞ "–ü–æ—Å–∏–ª–∞–Ω–Ω—è" –∑ –ª–∞–ø–∫–æ—é
            // --- –ó–ú–Ü–ù–ï–ù–û –ö–û–õ–¨–û–†–ò –ö–ù–û–ü–ö–ò 2 ---
            const linkTexture = createTextTexture('üêæ', 100, '#ffffff', '#ffb9b9'); // –ë—ñ–ª–∞ –ª–∞–ø–∫–∞ –Ω–∞ —Ñ–æ–Ω—ñ #ffb9b9
            const linkMaterial = new THREE.MeshBasicMaterial({ map: linkTexture });
            const linkIcon = new THREE.Mesh(iconGeometry, linkMaterial);
            linkIcon.position.set(0.3, -0.4, 0.01);
            linkIcon.userData = { 
                clickable: true, 
                action: 'link', 
                url: 'https://github.com/nervoushomebody'
            };
            group.add(linkIcon);

            // --- –û–ë–†–û–ë–ö–ê –ù–ê–¢–ò–°–ö–ê–ù–¨ ---
            const raycaster = new THREE.Raycaster();
            const mouse = new THREE.Vector2();

            const handleClick = (event) => {
                const clientX = event.clientX || event.touches[0].clientX;
                const clientY = event.clientY || event.touches[0].clientY;
                mouse.x = (clientX / window.innerWidth) * 2 - 1;
                mouse.y = -(clientY / window.innerHeight) * 2 + 1;

                raycaster.setFromCamera(mouse, camera);
                const intersects = raycaster.intersectObjects(group.children, true);

                if (intersects.length > 0) {
                    const object = intersects[0].object;
                    if (object.userData.clickable && object.userData.action === 'link') {
                        window.open(object.userData.url, '_blank');
                    }
                }
            };

            document.addEventListener('click', handleClick);
            document.addEventListener('touchend', (e) => handleClick(e.changedTouches[0]));

            // --- –ó–ê–ü–£–°–ö –Ü –ê–ù–Ü–ú–ê–¶–Ü–Ø ---
            const clock = new THREE.Clock();
            await mindarThree.start();
            
            renderer.setAnimationLoop(() => {
                const elapsedTime = clock.getElapsedTime();
                const scale = 1 + Math.sin(elapsedTime * 5) * 0.1;
                emailIcon.scale.set(scale, scale, 1);
                linkIcon.scale.set(scale, scale, 1);
                renderer.render(scene, camera);
            });
        });
    </script>
</body>
</html>
